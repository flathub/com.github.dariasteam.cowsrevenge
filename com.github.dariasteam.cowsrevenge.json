{
    "app-id": "com.github.dariasteam.cowsrevenge",
    "branch": "stable",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "20.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "cowsrevenge",
    "finish-args": [
        "--socket=x11",
        "--socket=pulseaudio",
        "--persist=.godot",
        "--share=ipc",
        "--device=dri"
    ],
    "build-options": {
        "split": false,
        "no-debuginfo": true
    },
    "modules": [
        "shared-modules/python2.7/python-2.7.json",
        {
            "name": "scons",
            "buildsystem": "simple",
            "build-commands": [
                "python setup.py install --prefix=/app"
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/scons/scons/4.1.0/scons-4.1.0.tar.gz",
                    "sha256": "72d28d762e2126787f173e3d59e089239f8b2f4e9ef3114d57f10b1206985d85",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": "4770",
                        "url-template": "https://downloads.sourceforge.net/project/scons/scons/$version/scons-$version.tar.gz"
                    }
                }
            ]
        },
        "shared-modules/glu/glu-9.json",
        {
            "name": "godot",
            "buildsystem": "simple",
            "build-commands": [
                "scons platform=server \\\n            CCFLAGS=-I/app/include \\\n            prefix=/app \\\n            unix_global_settings_path=/app \\\n            verbose=yes \\\n            -j `nproc` \\\n            target=release_debug \\\n            use_llvm=yes \\\n            builtin_freetype=no \\\n            builtin_libmpcdec=yes \\\n            builtin_libogg=no \\\n            builtin_libpng=no \\\n            builtin_libtheora=no \\\n            builtin_libvorbis=no \\\n            builtin_libwebp=no \\\n            builtin_libvpx=no \\\n            builtin_zlib=no \\\n            builtin_opus=yes \\\n            builtin_speex=yes \\\n            builtin_squish=yes \\\n            pulseaudio=yes \\\n            udev=no \\\n            tools=yes",
                "install -D -m755 bin/godot* /app/bin/godot-bin"
            ],
            "cleanup": [
                "/bin/godot-bin"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/godotengine/godot",
                    "tag": "2.1.5-stable"
                }
            ]
        },
        {
            "name": "godot-release-template",
            "buildsystem": "simple",
            "build-commands": [
                "scons platform=x11 \\\n            CCFLAGS=-I/app/include \\\n            prefix=/app \\\n            unix_global_settings_path=/app \\\n            verbose=yes \\\n            -j `nproc` \\\n            target=release \\\n            use_llvm=yes \\\n            builtin_freetype=no \\\n            builtin_libmpcdec=yes \\\n            builtin_libogg=no \\\n            builtin_libpng=no \\\n            builtin_libtheora=no \\\n            builtin_libvorbis=no \\\n            builtin_libwebp=no \\\n            builtin_libvpx=no \\\n            builtin_zlib=no \\\n            builtin_opus=yes \\\n            builtin_speex=yes \\\n            builtin_squish=yes \\\n            pulseaudio=yes \\\n            udev=no \\\n            tools=no",
                "install -D -m755 bin/godot.x11.opt.*.llvm /app/templates/linux_x11_`getconf LONG_BIT`_release"
            ],
            "cleanup": [
                "/templates"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/godotengine/godot",
                    "tag": "2.1.5-stable"
                }
            ]
        },
        {
            "name": "cowsrevenge",
            "buildsystem": "simple",
            "build-commands": [
                "mkdir -p /app/cowsrevenge",
                "mv * /app/cowsrevenge/",
                "cd /app/cowsrevenge/; ../bin/godot-bin -export 'Linux X11' cowsrevenge",
                "install -D -m755 /app/cowsrevenge/cowsrevenge /app/bin/",
                "install -D -m644 /app/cowsrevenge/linux_build/com.github.dariasteam.cowsrevenge.desktop \\\n                          /app/share/applications/com.github.dariasteam.cowsrevenge.desktop",
                "install -D -m644 /app/cowsrevenge/linux_build/com.github.dariasteam.cowsrevenge.appdata.xml \\\n                          /app/share/metainfo/com.github.dariasteam.cowsrevenge.appdata.xml",
                "install -D -m755 /app/cowsrevenge/linux_build/cowsrevenge_icon_64.png \\\n                          /app/share/icons/hicolor/64x64/apps/com.github.dariasteam.cowsrevenge.png",
                "install -D -m755 /app/cowsrevenge/linux_build/cowsrevenge_icon_128.png \\\n                          /app/share/icons/hicolor/128x128/apps/com.github.dariasteam.cowsrevenge.png",
                "rm -rf /app/cowsrevenge"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/Dariasteam/Cows-Revenge",
                    "branch": "stable"
                }
            ]
        }
    ]
}